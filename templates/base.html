<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Trinetra{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --bg: #0f1216;
            --bg-elev: #151a21;
            --text: #e6e9ee;
            --muted: #9aa3af;
            --border: #243040;
            --card: #161b22;
            --card-header: #1d2430;
            --link: #7aa2ff;
            --link-hover: #a7beff;
            --table-stripe: #12161c;
        }
        html, body { background-color: var(--bg); color: var(--text); }
        a { color: var(--link); }
        a:hover { color: var(--link-hover); }
        .navbar-dark.bg-dark { background-color: #0b0f14 !important; }
        .navbar-brand { font-weight: bold; color: var(--text) !important; }
        .navbar .navbar-text, .navbar .badge { color: var(--text); }
        .btn-outline-light { border-color: var(--border); color: var(--text); }
        .btn-outline-light:hover { background: var(--card-header); }

        .card { background-color: var(--card); border-color: var(--border); color: var(--text); }
        .card-header { background-color: var(--card-header); border-bottom-color: var(--border); color: var(--text); }
        .modal-content { background-color: var(--card); color: var(--text); border-color: var(--border); }
        .modal-body { color: var(--text); }

        .table { color: var(--text); }
        .table thead { color: var(--text); }
        .table-hover tbody tr:hover { background-color: var(--bg-elev); }
        .table-striped > tbody > tr:nth-of-type(odd) { background-color: var(--table-stripe); }
        .table > :not(caption) > * > * { background-color: transparent; border-bottom-color: var(--border); }

        .form-control, .form-select, .input-group-text { 
            background-color: #0f141a; 
            border-color: var(--border); 
            color: var(--text); 
        }
        .form-control::placeholder { color: #6b7280; }
        .form-text { color: var(--muted) !important; }
        label.form-label { color: var(--text); }

        .alert { color: var(--text); border-color: var(--border); }
        .alert-info { background-color: #0d1a2b; border-left: 4px solid #0ea5e9; }
        .alert-warning { background-color: #2a1f0a; border-left: 4px solid #f59e0b; }
        .alert-success { background-color: #0d2417; border-left: 4px solid #22c55e; }
        .alert-danger { background-color: #2a0e10; border-left: 4px solid #ef4444; }

        .btn-outline-primary { color: #93c5fd; border-color: #3b82f6; }
        .btn-outline-primary:hover { background-color: #1e3a8a; color: #e5edff; }
        .btn-outline-info { color: #67e8f9; border-color: #22d3ee; }
        .btn-outline-info:hover { background-color: #0e7490; color: #e0fcff; }
        .btn-outline-danger { color: #fca5a5; border-color: #ef4444; }
        .btn-outline-danger:hover { background-color: #7f1d1d; color: #ffe5e5; }
        .btn-outline-secondary { color: #cbd5e1; border-color: #475569; }
        .btn-outline-secondary:hover { background-color: #1f2937; color: #e5e7eb; }

        .bg-light { background-color: #111827 !important; color: var(--text); }
        .text-muted { color: var(--muted) !important; }

        .drug-alert { background-color: #2a0e10; border-left: 4px solid #ef4444; }
        .normal-message { background-color: #0d2417; border-left: 4px solid #22c55e; }
        .suspicious-badge { background-color: #dc3545; }
        .safe-badge { background-color: #28a745; }
        .navbar-brand { font-weight: bold; }
        .alert-card { transition: all 0.3s ease; }
        .alert-card:hover { transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,0.4); }

        .btn-close { filter: invert(1) grayscale(100%); }
        hr { border-color: var(--border); }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('dashboard') if session.username else url_for('login') }}">
                <img src="/static/images/Image2.jpg" alt="shield" style="width:48px; height:48px;"> Trinetra
            </a>
            {% if session.username %}
            <div class="navbar-nav ms-auto">
                <span class="navbar-text me-3">
                    Welcome, {{ session.username }}
                    {% if user and user.telegram_linked %}
                        <span class="badge bg-success ms-2">
                            <i class="fab fa-telegram"></i> Linked
                        </span>
                    {% else %}
                        <span class="badge bg-warning ms-2">
                            <i class="fab fa-telegram"></i> Not Linked
                        </span>
                    {% endif %}
                </span>
                <a class="btn btn-outline-light btn-sm" href="{{ url_for('logout') }}">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </a>
            </div>
            {% endif %}
        </div>
    </nav>

    <main class="container mt-4">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ 'danger' if category == 'error' else 'success' if category == 'success' else 'warning' }} alert-dismissible fade show">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    {% block scripts %}{% endblock %}
</body>
</html>
